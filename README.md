# MambaLFSR
Enhancing Light Field Image Super-Resolution through Mamba-based Spatial-Angular Correlation Modeling (MambaLFSR)

## Results
We share the pre-trained models and the SR LF images generated by our RR-HLFSR model for 4x LF spatial SR, which are avaliable at
链接: https://pan.baidu.com/s/1aJ8p8EUGyP4dOhlUdiaDTQ?pwd=dzwr 提取码: dzwr

### Dependencies
* Python 3.6
* Pyorch 1.3.1 + torchvision 0.4.2 + cuda 92
* Matlab

This code is built up on the [Basic-LFSR](https://github.com/ZhengyuLiang24/BasicLFSR). Please go to orginal code for more guideline information. 

### Dataset
We use the processed data by [LF-DFnet](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9286855), including EPFL, HCInew, HCIold, INRIA and STFgantry datasets for training and testing. Please download the dataset in the official repository of [LF-DFnet](https://github.com/YingqianWang/LF-DFnet).

### Prepare Training and Test Data
* To generate the training data, please first download the five datasets and run:
  ```matlab
  Generate_Data_for_Training.m
* To generate the test data, run:
  ```matlab
  Generate_Data_for_Test.m
### Train
* Run:
  ```python
  python train.py  --model_name RR_HLFSR --angRes 5 --scale_factor 4 --n_groups 6 --channels 64  --crop_test_method 3  
### Test
* Run:
  ```python
  python test.py --model_name RR_HLFSR --angRes 5 --upscale_factor 4 --n_groups 6 --channels 64  --crop_test_method 1 --self_ensemble True  --model_path [pre-trained dir]
  
[Important note]: 

For our Mamba method, the performance is following “the larger image patch size is the better”. For example, if we keep the whole image as an input of our network (i.e., crop_test_method is fixed equal to 1), it can be achieved the best performance. This is because our proposed network components require an adequate size of an input image to better exploit the pixel correlations in a larger receptive field.
  
## Acknowledgement
Our work and implementations are inspired and based on the following projects: <br> 
[Basic-LFSR](https://github.com/ZhengyuLiang24/BasicLFSR)<br> 
[LF-DFnet](https://github.com/YingqianWang/LF-DFnet)<br> 
[LF-InterNet](https://github.com/YingqianWang/LF-InterNet)<br>
We sincerely thank the authors for sharing their code and amazing research work!

## Contact
if you have any question, please contact me through email csr_20010517@163.com


